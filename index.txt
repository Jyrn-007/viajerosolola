<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viajeros - Agencia de Viajes</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
        }
        
        .navbar-brand {
            font-weight: 700;
            color: #28a745 !important;
        }
        
        .hero-section {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://placehold.co/1920x1080?text=Viajes+Inolvidables');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 100px 0;
            margin-bottom: 50px;
        }
        
        .product-card {
            transition: transform 0.3s;
            margin-bottom: 20px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .product-card:hover {
            transform: translateY(-5px);
        }
        
        .product-image {
            height: 200px;
            object-fit: cover;
        }
        
        .login-form {
            max-width: 500px;
            margin: 50px auto;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            background-color: white;
        }
        
        .admin-panel {
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <!-- Header superior -->
    <div class="bg-dark text-light py-1">
        <div class="container d-flex justify-content-between small">
            <div>
                <i class="fa fa-envelope"></i> viajescoutlatam@gmail.com |
                <i class="fa fa-phone"></i> +502 4480 2545
            </div>
            <div>
                <a href="#" class="text-light me-2"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="text-light me-2"><i class="fab fa-twitter"></i></a>
                <a href="#" class="text-light me-2"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </div>

    <!-- Barra de navegación -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="#" id="brand">VIAJERO</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navMenu">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="#" id="homeLink">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link" href="#" id="aboutLink">Acerca de</a></li>
                    <li class="nav-item"><a class="nav-link" href="#" id="productsLink">Tours</a></li>
                </ul>
                <div class="d-flex" id="authButtons">
                    <button class="btn btn-success me-2" id="loginBtn">Iniciar sesión</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Contenido dinámico -->
    <div id="appContent">
        <!-- Home Page -->
        <div id="homePage">
            <div class="hero-section text-center">
                <h1 class="display-4 fw-bold">Explora el mundo con nosotros</h1>
                <p class="lead">Descubre los mejores destinos al mejor precio</p>
            </div>

            <div class="container my-5">
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <img src="https://placehold.co/600x400?text=Visión+de+Viajes" class="img-fluid rounded shadow" alt="Acerca de nuestra agencia">
                    </div>
                    <div class="col-md-6">
                        <h2 class="fw-bold mb-4">Nuestra Visión</h2>
                        <p class="lead">Ofrecemos los Mejores Paquetes de Tour Dentro de Tu Presupuesto</p>
                        <p>Somos una agencia comprometida con proporcionar experiencias únicas e inolvidables. Nuestro equipo de expertos en viajes está listo para ayudarte a planificar tus próximas vacaciones soñadas.</p>
                        <div class="d-flex mt-4">
                            <div class="me-3 text-center">
                                <img src="https://placehold.co/100x100?text=Calidad" class="rounded-circle mb-2" alt="Garantía de calidad">
                                <h6>Calidad Garantizada</h6>
                            </div>
                            <div class="text-center">
                                <img src="https://placehold.co/100x100?text=Experiencia" class="rounded-circle mb-2" alt="Años de experiencia">
                                <h6>15+ Años de Experiencia</h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Productos destacados -->
            <div class="bg-light py-5">
                <div class="container">
                    <h2 class="text-center mb-5">Nuestros Tours Populares</h2>
                    <div class="row" id="featuredProducts"></div>
                </div>
            </div>
        </div>

        <!-- Login Page (hidden by default) -->
        <div id="loginPage" style="display: none;">
            <div class="container">
                <div class="login-form">
                    <h2 class="text-center mb-4">Iniciar Sesión</h2>
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="username" class="form-label">Usuario</label>
                            <input type="text" class="form-control" id="username" required>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Contraseña</label>
                            <input type="password" class="form-control" id="password" required>
                        </div>
                        <button type="submit" class="btn btn-success w-100">Ingresar</button>
                        <div class="alert alert-danger mt-3" id="loginError" style="display: none;"></div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Admin Page (hidden by default) -->
        <div id="adminPage" style="display: none;">
            <div class="container admin-panel">
                <h2 class="mb-4">Panel de Administración</h2>
                <div class="d-flex justify-content-between mb-4">
                    <h4>Gestión de Tours</h4>
                    <button class="btn btn-success" id="addProductBtn">Agregar Nuevo Tour</button>
                </div>
                
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Descripción</th>
                                <th>Precio</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="productsTable">
                            <!-- Productos se cargarán aquí -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para editar/agregar productos -->
    <div class="modal fade" id="productModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitle">Agregar Nuevo Tour</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="productForm">
                        <input type="hidden" id="productId">
                        <div class="mb-3">
                            <label for="productName" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="productName" required>
                        </div>
                        <div class="mb-3">
                            <label for="productDescription" class="form-label">Descripción</label>
                            <textarea class="form-control" id="productDescription" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="productPrice" class="form-label">Precio</label>
                            <input type="number" step="0.01" class="form-control" id="productPrice" required>
                        </div>
                        <div class="mb-3">
                            <label for="productImage" class="form-label">URL de la Imagen</label>
                            <input type="text" class="form-control" id="productImage" placeholder="https://example.com/image.jpg">
                        </div>
                        <div class="alert alert-danger" id="productError" style="display: none;"></div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" id="saveProductBtn">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h5>VIAJERO</h5>
                    <p>La mejor agencia de viajes en Guatemala. Ofrecemos experiencias únicas y personalizadas.</p>
                </div>
                <div class="col-md-4">
                    <h5>Contacto</h5>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-envelope me-2"></i> viajescoutlatam@gmail.com</li>
                        <li><i class="fas fa-phone me-2"></i> +502 4480 2545</li>
                        <li><i class="fas fa-map-marker-alt me-2"></i> Ciudad de Guatemala</li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h5>Síguenos</h5>
                    <a href="#" class="text-white me-3"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="text-white me-3"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="text-white me-3"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            <hr>
            <div class="text-center">
                <p class="mb-0">&copy; 2024 VIAJERO. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Simulación del backend
        class BackendService {
            constructor() {
                this.users = [
                    { id: 1, username: 'admin', password: '1234', role: 'admin' }
                ];
                
                this.products = [
                    { 
                        id: 1, 
                        nombre: "Paquete Europa", 
                        descripcion: "Tour por 5 países europeos incluyendo Francia, Italia, España, Alemania y Suiza", 
                        precio: 2500, 
                        imagen: "https://placehold.co/400x300?text=Tour+Europa" 
                    },
                    { 
                        id: 2, 
                        nombre: "Caribe Premium", 
                        descripcion: "7 noches en resorts todo incluido con vuelos y traslados", 
                        precio: 1800, 
                        imagen: "https://placehold.co/400x300?text=Caribe+Premium" 
                    }
                ];
                this.token = null;
            }
            
            login(username, password) {
                return new Promise((resolve, reject) => {
                    const user = this.users.find(u => u.username === username && u.password === password);
                    if (user) {
                        this.token = `fake-jwt-token-${username}`;
                        resolve({ 
                            success: true, 
                            token: this.token,
                            user: username,
                            role: user.role
                        });
                    } else {
                        reject({ success: false, message: 'Usuario o contraseña incorrectos' });
                    }
                });
            }
            
            logout() {
                this.token = null;
                return Promise.resolve({ success: true });
            }
            
            getProducts() {
                return Promise.resolve(this.products);
            }
            
            addProduct(product) {
                product.id = this.products.length + 1;
                this.products.push(product);
                return Promise.resolve(product);
            }
            
            updateProduct(id, productData) {
                const index = this.products.findIndex(p => p.id === id);
                if (index !== -1) {
                    this.products[index] = { ...this.products[index], ...productData };
                    return Promise.resolve(this.products[index]);
                }
                return Promise.reject({ message: 'Producto no encontrado' });
            }
            
            deleteProduct(id) {
                const initialLength = this.products.length;
                this.products = this.products.filter(p => p.id !== id);
                return Promise.resolve(this.products.length < initialLength);
            }
            
            isAuthenticated() {
                return this.token !== null;
            }
        }

        // App State
        const state = {
            currentUser: null,
            products: [],
            currentPage: 'home'
        };

        // Services
        const backend = new BackendService();

        // Controllers
        const AuthController = {
            login: async (username, password) => {
                try {
                    const response = await backend.login(username, password);
                    state.currentUser = response.user;
                    
                    if (response.role === 'admin') {
                        showPage('admin');
                    } else {
                        showPage('home');
                    }
                    
                    updateAuthButtons();
                    return { success: true };
                } catch (error) {
                    return error;
                }
            },
            
            logout: async () => {
                await backend.logout();
                state.currentUser = null;
                showPage('home');
                updateAuthButtons();
            },
            
            checkAuth: () => {
                return backend.isAuthenticated();
            }
        };

        const ProductController = {
            loadProducts: async () => {
                state.products = await backend.getProducts();
                renderFeaturedProducts();
                
                if (state.currentPage === 'admin') {
                    renderProductsTable();
                }
            },
            
            addProduct: async (product) => {
                try {
                    const newProduct = await backend.addProduct(product);
                    state.products.push(newProduct);
                    renderFeaturedProducts();
                    renderProductsTable();
                    return { success: true };
                } catch (error) {
                    return error;
                }
            },
            
            updateProduct: async (id, productData) => {
                try {
                    const updatedProduct = await backend.updateProduct(id, productData);
                    const index = state.products.findIndex(p => p.id === id);
                    if (index !== -1) {
                        state.products[index] = updatedProduct;
                    }
                    renderFeaturedProducts();
                    renderProductsTable();
                    return { success: true };
                } catch (error) {
                    return error;
                }
            },
            
            deleteProduct: async (id) => {
                try {
                    const success = await backend.deleteProduct(id);
                    if (success) {
                        state.products = state.products.filter(p => p.id !== id);
                        renderFeaturedProducts();
                        renderProductsTable();
                    }
                    return { success };
                } catch (error) {
                    return error;
                }
            }
        };

        // View Functions
        function showPage(page) {
            state.currentPage = page;
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('adminPage').style.display = 'none';
            
            if (page === 'home') {
                document.getElementById('homePage').style.display = 'block';
            } else if (page === 'login') {
                document.getElementById('loginPage').style.display = 'block';
            } else if (page === 'admin') {
                document.getElementById('adminPage').style.display = 'block';
            }
        }

        function updateAuthButtons() {
            const authButtonsDiv = document.getElementById('authButtons');
            
            if (state.currentUser) {
                authButtonsDiv.innerHTML = `
                    <span class="text-dark me-3">Hola, ${state.currentUser}</span>
                    <button class="btn btn-outline-danger" id="logoutBtn">Cerrar sesión</button>
                `;
                document.getElementById('logoutBtn').addEventListener('click', async () => {
                    await AuthController.logout();
                });
            } else {
                authButtonsDiv.innerHTML = `
                    <button class="btn btn-success me-2" id="loginBtn">Iniciar sesión</button>
                `;
                document.getElementById('loginBtn').addEventListener('click', () => {
                    showPage('login');
                });
            }
        }

        function renderFeaturedProducts() {
            const container = document.getElementById('featuredProducts');
            container.innerHTML = '';
            
            state.products.slice(0, 4).forEach(product => {
                const col = document.createElement('div');
                col.className = 'col-md-3 mb-4';
                col.innerHTML = `
                    <div class="card product-card h-100">
                        <img src="${product.imagen}" class="card-img-top product-image" alt="${product.nombre}">
                        <div class="card-body">
                            <h5 class="card-title">${product.nombre}</h5>
                            <p class="card-text">${product.descripcion.substring(0, 50)}...</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="text-success fw-bold">Q${product.precio.toFixed(2)}</span>
                                <button class="btn btn-sm btn-outline-success">Ver detalles</button>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(col);
            });
        }

        function renderProductsTable() {
            const tbody = document.getElementById('productsTable');
            tbody.innerHTML = '';
            
            state.products.forEach(product => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${product.nombre}</td>
                    <td>${product.descripcion.substring(0, 30)}...</td>
                    <td>Q${product.precio.toFixed(2)}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary edit-product" data-id="${product.id}">Editar</button>
                        <button class="btn btn-sm btn-outline-danger ms-2 delete-product" data-id="${product.id}">Eliminar</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
            
            // Add event listeners
            document.querySelectorAll('.edit-product').forEach(btn => {
                btn.addEventListener('click', () => {
                    const productId = parseInt(btn.dataset.id);
                    const product = state.products.find(p => p.id === productId);
                    if (product) {
                        openProductModal(product);
                    }
                });
            });
            
            document.querySelectorAll('.delete-product').forEach(btn => {
                btn.addEventListener('click', () => {
                    const productId = parseInt(btn.dataset.id);
                    if (confirm('¿Está seguro que desea eliminar este producto?')) {
                        ProductController.deleteProduct(productId);
                    }
                });
            });
        }

        function openProductModal(product = null) {
            const modal = new bootstrap.Modal(document.getElementById('productModal'));
            const title = document.getElementById('modalTitle');
            const form = document.getElementById('productForm');
            
            document.getElementById('productError').style.display = 'none';
            
            if (product) {
                // Editar producto existente
                title.textContent = 'Editar Tour';
                document.getElementById('productId').value = product.id;
                document.getElementById('productName').value = product.nombre;
                document.getElementById('productDescription').value = product.descripcion;
                document.getElementById('productPrice').value = product.precio;
                document.getElementById('productImage').value = product.imagen;
            } else {
                // Nuevo producto
                title.textContent = 'Agregar Nuevo Tour';
                form.reset();
            }
            
            modal.show();
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize
            updateAuthButtons();
            showPage('home');
            ProductController.loadProducts();
            
            // Login Form
            document.getElementById('loginForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                const result = await AuthController.login(username, password);
                if (!result.success) {
                    const errorDiv = document.getElementById('loginError');
                    errorDiv.textContent = result.message;
                    errorDiv.style.display = 'block';
                }
            });
            
            // Navigation
            document.getElementById('homeLink').addEventListener('click', (e) => {
                e.preventDefault();
                showPage('home');
            });
            
            document.getElementById('productsLink').addEventListener('click', (e) => {
                e.preventDefault();
                showPage('home');
                document.getElementById('products').scrollIntoView({ behavior: 'smooth' });
            });
            
            // Product Modal Save Button
            document.getElementById('saveProductBtn').addEventListener('click', async () => {
                const form = document.getElementById('productForm');
                const productId = document.getElementById('productId').value;
                const productData = {
                    nombre: document.getElementById('productName').value,
                    descripcion: document.getElementById('productDescription').value,
                    precio: parseFloat(document.getElementById('productPrice').value),
                    imagen: document.getElementById('productImage').value || 'https://placehold.co/400x300?text=Tour+Foto'
                };
                
                const errorDiv = document.getElementById('productError');
                
                if (!productData.nombre || !productData.precio) {
                    errorDiv.textContent = 'Nombre y precio son requeridos';
                    errorDiv.style.display = 'block';
                    return;
                }
                
                if (productId) {
                    // Update existing product
                    const result = await ProductController.updateProduct(parseInt(productId), productData);
                    if (result.success) {
                        bootstrap.Modal.getInstance(document.getElementById('productModal')).hide();
                    } else {
                        errorDiv.textContent = result.message || 'Error al actualizar el producto';
                        errorDiv.style.display = 'block';
                    }
                } else {
                    // Add new product
                    const result = await ProductController.addProduct(productData);
                    if (result.success) {
                        bootstrap.Modal.getInstance(document.getElementById('productModal')).hide();
                    } else {
                        errorDiv.textContent = result.message || 'Error al agregar el producto';
                        errorDiv.style.display = 'block';
                    }
                }
            });
            
            // Add Product Button
            document.getElementById('addProductBtn').addEventListener('click', () => {
                openProductModal();
            });
        });
    </script>
</body>
</html>
